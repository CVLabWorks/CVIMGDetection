# NPR

## 注

原论文的.md文件在./file.md，
模型的修改主要在文件./networks/resnet.py，
修改配置与超参数在./options/。

数据集genimage置于项目根目录下，遵循格式：
./genimage/
├── adm/
│   ├── nature/
│   │   ├── image1.jpg
│   │   ├── image2.jpg
│   │   └── ...
│   └── ai/
│       ├── image1.jpg
│       ├── image2.jpg
│       └── ...
├── biggan/
│   ├── nature/
│   └── ai/
├── glide/
│   ├── nature/
│   └── ai/
└── ... (其他类别)

## 改进点

### 1. 多尺度NPR融合 (MultiScale NPR)

基于论文NPR 概念，原始方法仅使用单一尺度(0.5)进行上采样痕迹检测。多尺度NPR融合通过引入多个采样尺度(0.25, 0.5, 0.75)，能够捕获不同粒度级别的上采样痕迹。
在原始NPR计算基础上，增加两个额外的尺度，采用加权融合策略整合多尺度特征，保持模型整体架构不变，仅在前处理阶段进行扩展。

### 2. 通道注意力增强 (Channel Attention)

在ResNet的关键层级引入轻量级通道注意力机制，使模型能够自适应地关注对检测上采样痕迹最重要的特征通道。

- 在conv1和layer1输出后添加通道注意力模块
- 使用全局平均池化和最大池化的双路径设计
- 通过Sigmoid激活生成通道权重，实现特征重标定

## 实验结果

### 性能对比表

| 方法 |  Acc/Prec |
|------|-------------------|
| baseline |  0.961 / 0.994 |
| +特征融合 |  0.951 / 0.992 |
| +通道注意力 |  0.965 / 0.995 |
| ++组合方法 | 0.952 / 0.993 |

### 结果

**通道注意力的优势：** 
通道注意力机制通过自适应特征选择，增强了模型对关键上采样痕迹的敏感性，使模型能够聚焦于最具判别力的特征通道，同时抑制无关噪声，从而提升了检测的鲁棒性和泛化能力。

**特征融合的不足：** 
可能由于多尺度NPR融合引入了冗余特征或噪声，导致模型过拟合到训练数据的特定模式，而未能有效泛化，同时多尺度信息可能分散了模型的注意力，使得主要的上采样痕迹被稀释，从而降低了检测效率。

**组合方法的局限性：** 
两种改进策略可能相互冲突，特征融合的多尺度信息干扰了通道注意力的特征选择过程，导致模型无法协调学习，同时组合后的模型复杂度增加，优化难度加大，从而限制了性能提升。